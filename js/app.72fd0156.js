(function(t){function e(e){for(var a,o,i=e[0],c=e[1],u=e[2],d=0,m=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(m.length)m.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,i=1;i<n.length;i++){var c=n[i];0!==s[c]&&(a=!1)}a&&(r.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},s={app:0},r=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"13dd":function(t,e,n){"use strict";n("f60d")},"440b":function(t,e,n){"use strict";n("b129")},"4a71":function(t,e,n){"use strict";n("a88b")},"4cef":function(t,e,n){},5558:function(t,e,n){"use strict";n("4cef")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=n("2106"),r=n.n(s),o=n("5132"),i=n.n(o),c=n("bc3a"),u=n.n(c),l=u.a.create({baseURL:"https://ha-talk-api.herokuapp.com/",timeout:1e4,withCredentials:!0}),d=l,m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},p=[],v=(n("5c0b"),n("2877")),f={},h=Object(v["a"])(f,m,p,!1,null,null,null),g=h.exports,w=n("9483");Object(w["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});n("45fc"),n("96cf");var b=n("1da1"),C=n("8c4f"),_=(n("7db0"),n("b0c0"),n("2f62"));a["a"].use(_["a"]);var x=new _["a"].Store({state:{name:null,account:null,friends:[],auth:!1},mutations:{setUser:function(t,e){var n=e.name,a=e.account,s=e.friends;t.name=n,t.account=a,t.friends=s},updateUserName:function(t,e){t.name=e}},actions:{getUser:function(t){return Object(b["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.state,e.next=3,d.get("/GetUser").then((function(t){var e=t.data,a=e.name,s=e.account,r=e.friends,o=e.success;o&&(n.name=a,n.account=s,n.friends=r,n.auth=!0)}));case 3:case"end":return e.stop()}}),e)})))()}},getters:{getFriendName:function(t){return function(e){var n=t.friends.find((function(t){return t.account===e}));return n?n.name:""}},userData:function(t){return!!t.account}},modules:{}}),k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outer"},[n("menu-component"),n("div",{staticClass:"container"},t._l(t.firends,(function(e){return n("router-link",{key:e.account,staticClass:"content",attrs:{to:"/Chat/"+e.account}},[n("div",{staticClass:"user"},[n("div",{staticClass:"avatar"},[n("img",{attrs:{src:t.avatarImg,alt:""}})]),n("div",{staticClass:"name"},[t._v(t._s(e.name))])])])})),1)],1)},y=[],P=n("a692"),E=n.n(P),$={data:function(){return{avatarImg:E.a}},computed:{firends:function(){return this.$store.state.friends}},created:function(){this.$store.dispatch("getUser")}},N=$,j=(n("5558"),Object(v["a"])(N,k,y,!1,null,"ccffd752",null)),O=j.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outer"},[n("menu-component"),n("div",{staticClass:"container"},[n("div",{staticClass:"content"},[n("div",{staticClass:"room"},[t._v(t._s(t.friend))]),n("div",{attrs:{id:"text_area"}},t._l(t.message,(function(e){return n("div",{key:e.time,staticClass:"msg",class:{user:t.account===e.user}},[n("div",{staticClass:"avatar"},[n("img",{attrs:{src:t.avatarImg,alt:""}})]),n("div",{staticClass:"text"},[t._v(t._s(e.text))])])})),0),n("form",{staticClass:"input",on:{submit:function(e){return e.preventDefault(),t.send(e)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.msg,expression:"msg"}],attrs:{type:"text",placeholder:"輸入訊息"},domProps:{value:t.msg},on:{input:function(e){e.target.composing||(t.msg=e.target.value)}}}),n("button",{staticClass:"btn",on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}}},[t._v("送出")])])])])],1)},A=[],R={data:function(){return{message:[],msg:null,friend:null,avatarImg:E.a}},computed:{account:function(){return this.$store.state.account}},mounted:function(){var t=this,e=this,n=this.$store.getters.getFriendName,a=this.$route.params.id,s=this.axios;e.friend=n(a),this.$socket.emit("bind room",a),this.sockets.subscribe("chat message",(function(e){t.message.push(e)})),s.get("/getMsg",{params:{account:a}}).then((function(t){e.message=t.data}))},methods:{send:function(){this.msg&&(this.$socket.emit("chat message",this.msg),this.msg=null)}},updated:function(){var t=document.getElementById("text_area");t.scrollTop=t.scrollHeight-t.offsetHeight}},U=R,I=(n("13dd"),Object(v["a"])(U,F,A,!1,null,"211a67dc",null)),q=I.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outer"},[n("div",{staticClass:"container"},[n("div",{staticClass:"left"},[n("form",{staticClass:"login",on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[t._m(0),n("div",{staticClass:"row",class:{loginErr:t.loginErr}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],attrs:{type:"text",placeholder:"輸入帳號"},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}})]),n("div",{staticClass:"row",class:{loginErr:t.loginErr}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"輸入密碼"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),n("div",{staticClass:"row"},[n("router-link",{staticClass:"btn",attrs:{to:"/register"}},[t._v(" 註冊 ")]),n("button",{staticClass:"btn",on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}}},[t._v("登入")])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loginErr,expression:"loginErr"}],staticClass:"err"},[t._v("登入失敗請輸入正確帳號密碼")])]),t._m(1)])])},D=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},[n("h2",[t._v("Login")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"right"},[n("h1",[t._v("HaTalk")]),n("span",[t._v("Copyright © 2020 Viaje9 Design.")])])}],T={data:function(){return{account:null,password:null,loginErr:!1}},methods:{login:function(){var t=this,e=this.axios,n=this.$store,a=this.$router,s=this.account,r=this.password;e.post("/Login",{account:s,password:r}).then(function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!s.data.success){e.next=6;break}return e.next=3,n.dispatch("getUser");case 3:a.push("/").catch((function(t){return console.warn(t)})),e.next=7;break;case 6:t.loginErr=!0;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},H=T,M=(n("c67d"),Object(v["a"])(H,S,D,!1,null,"6cbbc062",null)),L=M.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outer"},[n("div",{staticClass:"container"},[n("div",{staticClass:"left"},[n("form",{on:{submit:function(e){return e.preventDefault(),t.checkForm(e)}}},[t._m(0),n("div",{staticClass:"row",class:{registerErr:t.errorRegister}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{id:"name",name:"name",type:"text",minlength:"1",maxlength:"10",required:"",placeholder:"輸入暱稱"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),n("div",{staticClass:"row",class:{registerErr:t.errorAccount||t.errorRegister}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],attrs:{id:"account",name:"account",type:"text",minlength:"4",maxlength:"20",required:"",placeholder:"輸入帳號"},domProps:{value:t.account},on:{change:t.checkAccount,input:function(e){e.target.composing||(t.account=e.target.value)}}})]),n("div",{staticClass:"row",class:{registerErr:t.errorPassword||t.errorRegister}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{id:"password",name:"password",type:"password",minlength:"8",maxlength:"20",required:"",placeholder:"輸入密碼"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),n("div",{staticClass:"row",class:{registerErr:t.errorPassword||t.errorRegister}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.checkPassword,expression:"checkPassword"}],attrs:{id:"checkPassword",name:"checkPassword",type:"password",required:"",placeholder:"確認密碼"},domProps:{value:t.checkPassword},on:{input:function(e){e.target.composing||(t.checkPassword=e.target.value)}}})]),n("div",{staticClass:"row"},[n("router-link",{staticClass:"btn",attrs:{to:"/login"}},[t._v("取消")]),n("button",{staticClass:"btn",attrs:{type:"submit"}},[t._v("註冊")])],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.errorAccount||t.errorPassword||t.errorRegister,expression:"errorAccount || errorPassword || errorRegister"}],staticClass:"err"},[t._v(" "+t._s(t.errorAccount||t.errorPassword||t.errorRegister)+" ")])]),t._m(1)])])},B=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},[n("h2",[t._v("Registered")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"right"},[n("h1",[t._v("HaTalk")]),n("span",[t._v("Copyright © 2020 Viaje9 Design.")])])}],J={data:function(){return{name:null,account:null,password:null,checkPassword:null,errorAccount:null,errorPassword:null,errorRegister:null}},methods:{checkAccount:function(){var t=this;this.axios.get("/CheckAccount",{params:{account:this.account}}).then((function(e){t.errorAccount=e.data?null:"帳號重複請重新輸入"}))},checkForm:function(){var t=this;this.password===this.checkPassword&&null===this.errorAccount?this.axios.post("/Register",{name:this.name,account:this.account,password:this.password}).then((function(e){e.data.success?t.$store.commit("setUser","register"):t.errorRegister="註冊失敗"})):this.errorPassword="密碼不一致請重新輸入"}}},G=J,z=(n("a39d"),Object(v["a"])(G,V,B,!1,null,"3538badf",null)),K=z.exports,Q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outer"},[n("menu-component"),n("div",{staticClass:"container"},[n("div",{staticClass:"content"},[n("div",{staticClass:"top"},[n("div",{staticClass:"user"},[n("div",{staticClass:"avatar"},[n("img",{attrs:{src:t.avatarImg,alt:""}})]),n("div",{staticClass:"name"},[t._v(t._s(t.userName||123123123123))])])]),n("div",{staticClass:"btm"},[n("div",{staticClass:"change"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",maxlength:"10",placeholder:"更新暱稱"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),n("button",{staticClass:"btn",on:{click:t.changeName}},[t._v("更新")])])])])])],1)},W=[],X={data:function(){return{avatarImg:E.a,name:null}},computed:{userName:function(){return this.$store.state.name}},methods:{changeName:function(){var t=this;this.axios.put("/UpdateUserName",{name:this.name}).then((function(e){e.data.success||t.$router.push({path:"/Login"}),t.$store.commit("updateUserName",t.name),t.name=null}))}}},Y=X,Z=(n("e948"),Object(v["a"])(Y,Q,W,!1,null,"379b7614",null)),tt=Z.exports,et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outer"},[n("menu-component"),n("div",{staticClass:"container"},[n("div",{staticClass:"content"},[n("div",{staticClass:"top"},[n("div",{staticClass:"search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],attrs:{type:"text",placeholder:"搜索帳號"},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}}),n("button",{staticClass:"btn",on:{click:t.search}},[t._v("搜索")]),n("button",{directives:[{name:"show",rawName:"v-show",value:!t.notFind&&null!==t.user.name,expression:"!notFind && user.name !== null"}],staticClass:"btn",on:{click:t.addFriend}},[t._v(" 加入好友 ")]),n("span",{directives:[{name:"show",rawName:"v-show",value:t.notFind,expression:"notFind"}],staticClass:"notFind"},[t._v("找不到用戶")]),n("span",{directives:[{name:"show",rawName:"v-show",value:t.newFriesn,expression:"newFriesn"}],staticClass:"newFriesn"},[t._v("快跟新朋友聊天吧!")])])]),n("div",{staticClass:"btm",class:{find:t.user.account}},[n("div",{staticClass:"user"},[n("div",{staticClass:"avatar"},[n("img",{attrs:{src:t.avatarImg,alt:""}})]),n("div",{staticClass:"name"},[t._v(t._s(t.user.name))])])])])])],1)},nt=[],at={data:function(){return{avatarImg:E.a,account:null,user:{account:null,name:null},notFind:null,newFriesn:null}},methods:{search:function(){var t=this;this.axios.get("/SearchUser",{params:{account:this.account}}).then((function(e){t.newFriesn=null,t.account=null,e.data.success?(t.user=e.data.user,t.notFind=!1):(t.notFind=!0,t.user={account:null,name:null,state:null})}))},addFriend:function(){var t=this;this.axios.post("/AddFriend",{account:this.user.account}).then((function(e){e.data.success&&(t.$store.commit("setUser","newFriesn"),t.newFriesn=!0)}))}}},st=at,rt=(n("4a71"),Object(v["a"])(st,et,nt,!1,null,"45042f1e",null)),ot=rt.exports;a["a"].use(C["a"]);var it=[{path:"/",component:O,meta:{requiresAuth:!0}},{path:"/login",component:L},{path:"/register",component:K},{path:"/chat/:id",component:q,meta:{requiresAuth:!0}},{path:"/user",component:tt,meta:{requiresAuth:!0}},{path:"/search",component:ot,meta:{requiresAuth:!0}}],ct=new C["a"]({mode:"history",base:"/",routes:it});ct.beforeEach(function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(e,n,a){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=e.matched.some((function(t){return t.meta.requiresAuth})),n.matched.length){t.next=4;break}return t.next=4,x.dispatch("getUser");case 4:r=x.state.auth,s?r?a():a({path:"/login"}):a();case 6:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}());var ut=ct,lt=(n("f5df1"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outer"},[n("div",{staticClass:"head"},[n("h2",[t._v("HaTalk")]),n("div",{staticClass:"avatar"},[n("img",{attrs:{src:t.avatarImg,alt:""}})]),n("div",{staticClass:"name"},[t._v(t._s(t.name))])]),n("div",{staticClass:"body"},[n("router-link",{staticClass:"btn",attrs:{to:"/User"}}),n("router-link",{staticClass:"btn",attrs:{to:"/Search"}}),n("router-link",{staticClass:"btn",attrs:{to:"/"}}),n("router-link",{staticClass:"btn",attrs:{to:"/login"}})],1),t._m(0)])}),dt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"footer"},[n("span",[t._v("Copyright © 2021 Viaje9 Design.")])])}],mt={data:function(){return{avatarImg:E.a}},computed:{name:function(){return this.$store.state.name}}},pt=mt,vt=(n("440b"),Object(v["a"])(pt,lt,dt,!1,null,"c1adb486",null)),ft=vt.exports;a["a"].component("menu-component",ft),a["a"].use(r.a,d),a["a"].use(new i.a({connection:"https://ha-talk-api.herokuapp.com/"})),a["a"].config.productionTip=!1,new a["a"]({router:ut,store:x,render:function(t){return t(g)}}).$mount("#app")},5889:function(t,e,n){},"5c0b":function(t,e,n){"use strict";n("9c0c")},"9c0c":function(t,e,n){},a39d:function(t,e,n){"use strict";n("f760")},a692:function(t,e,n){t.exports=n.p+"img/avatar.2ca5f0e8.svg"},a88b:function(t,e,n){},b129:function(t,e,n){},c178:function(t,e,n){},c67d:function(t,e,n){"use strict";n("5889")},e948:function(t,e,n){"use strict";n("c178")},f60d:function(t,e,n){},f760:function(t,e,n){}});
//# sourceMappingURL=app.72fd0156.js.map